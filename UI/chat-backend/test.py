import json
import re


raw_er = 'tôi sẽ trích xuất thông tin từ văn bản và trả về kết quả dưới dạng json với các trường "relationships".\n\n```json\n{\n  "relationships": [\n    {\n      "source": {\n        "name": "world cup",\n        "description": "giải đấu bóng đá thế giới"\n      },\n      "target": {\n        "name": "fifa",\n        "description": "liên đoàn bóng đá thế giới"\n      },\n      "type_source": "event",\n      "type_target": "organization",\n      "relation": "được_tổ_chức_bởi"\n    },\n    {\n      "source": {\n        "name": "world cup",\n        "description": "giải đấu bóng đá thế giới"\n      },\n      "target": {\n        "name": "31 đội bóng",\n        "description": "số lượng đội bóng tham dự vòng chung kết"\n      },\n      "type_source": "event",\n      "type_target": "team",\n      "relation": "có_sự_tham_gia_của"\n    },\n    {\n      "source": {\n        "name": "khu vực châu á",\n        "description": "khu vực bóng đá"\n      },\n      "target": {\n        "name": "5.5 đội",\n        "description": "số lượng đội bóng tối đa tham dự vòng chung kết"\n      },\n      "type_source": "location",\n      "type_target": "team",\n      "relation": "có_số_lượng_đội_tối_đa"\n    },\n    {\n      "source": {\n        "name": "khu vực châu phi",\n        "description": "khu vực bóng đá"\n      },\n      "target": {\n        "name": "5 đội",\n        "description": "số lượng đội bóng tối đa tham dự vòng chung kết"\n      },\n      "type_source": "location",\n      "type_target": "team",\n      "relation": "có_số_lượng_đội_tối_đa"\n    },\n    {\n      "source": {\n        "name": "khu vực châu bắc, trung mỹ và caribe",\n        "description": "khu vực bóng đá"\n      },\n      "target": {\n        "name": "3.5 đội",\n        "description": "số lượng đội bóng tối đa tham dự vòng chung kết"\n      },\n      "type_source": "location",\n      "type_target": "team",\n      "relation": "có_số_lượng_đội_tối_đa"\n    },\n    {\n      "source": {\n        "name": "khu vực nam mỹ",\n        "description": "khu vực bóng đá"\n      },\n      "target": {\n        "name": "3.5 đội",\n        "description": "số lượng đội bóng tối đa tham dự vòng chung kết"\n      },\n      "type_source": "location",\n      "type_target": "team",\n      "relation": "có_số_lượng_đội_tối_đa"\n    },\n    {\n      "source": {\n        "name": "khu vực châu đại dương",\n        "description": "khu vực bóng đá"\n      },\n      "target": {\n        "name": "0.5 đội",\n        "description": "số lượng đội bóng tối đa tham dự vòng chung kết"\n      },\n      "type_source": "location",\n      "type_target": "team",\n      "relation": "có_số_lượng_đội_tối_đa"\n    },\n    {\n      "source": {\n        "name": "khu vực châu âu",\n        "description": "khu vực bóng đá"\n      },\n      "target": {\n        "name": "13 đội",\n        "description": "số lượng đội bóng tối đa tham dự vòng chung kết"\n      },\n      "type_source": "location",\n      "type_target": "team",\n      "relation": "có_số_lượng_đội_tối_đa"\n    },\n    {\n      "source": {\n        "name": "đội chủ nhà",\n        "description": "đội bóng"\n      },\n      "target": {\n        "name": "world cup",\n        "description": "giải đấu bóng đá thế giới"\n      },\n      "type_source": "team",\n      "type_target": "event",\n      "relation": "là_chủ_nhà_của"\n    }\n  ]\n}\n```\n\ntôi sẽ tiếp tục trích xuất thông tin từ văn bản và trả về kết quả dưới dạng json với các trường "relationships".\n\n```json\n{\n  "relationships": [\n    {\n      "source": {\n        "name": "vòng chung kết",\n        "description": "vòng đấu của world cup"\n      },\n      "target": {\n        "name": "8 bảng đấu",\n        "description": "số lượng bảng đấu trong vòng chung kết"\n      },\n      "type_source": "event",\n      "type_target": "group",\n      "relation": "có_số_lượng_bảng_đấu"\n    },\n    {\n      "source": {\n        "name": "bảng đấu",\n        "description": "bảng đấu trong vòng chung kết"\n      },\n      "target": {\n        "name": "4 đội bóng",\n        "description": "số lượng đội bóng trong một bảng đấu"\n      },\n      "type_source": "group",\n      "type_target": "team",\n      "relation": "có_số_lượng_đội_bóng"\n    },\n    {\n      "source": {\n        "name": "đội bóng",\n        "description": "đội bóng tham dự world cup"\n      },\n      "target": {\n        "name": "huấn luyện viên trưởng",\n        "description": "huấn luyện viên trưởng của đội bóng"\n      },\n      "type_source": "team",\n      "type_target": "person",\n      "relation": "có_huấn_luyện_viên_trưởng"\n    },\n    {\n      "source": {\n        "name": "đội bóng",\n        "description": "đội bóng tham dự world cup"\n      },\n      "target": {\n        "name": "trợ lý huấn luyện viên",\n        "description": "trợ lý huấn luyện viên của đội bóng"\n      },\n      "type_source": "team",\n      "type_target": "person",\n      "relation": "có_trợ_lý_huấn_luyện_viên"\n    },\n    {\n      "source": {\n        "name": "đội bóng",\n        "description": "đội bóng tham dự world cup"\n      },\n      "target": {\n        "name": "săn sóc viên",\n        "description": "săn sóc viên của đội bóng"\n      },\n      "type_source": "team",\n      "type_target": "person",\n      "relation": "có_săn_sóc_viên"\n    },\n    {\n      "source": {\n        "name": "đội bóng",\n        "description": "đội bóng tham dự world cup"\n      },\n      "target": {\n        "name": "cầu thủ",\n        "description": "cầu thủ của đội bóng"\n      },\n      "type_source": "team",\n      "type_target": "person",\n      "relation": "có_cầu_thủ"\n    }\n  ]\n}\n```\n\ntôi sẽ tiếp tục trích xuất thông tin từ văn bản và trả về kết quả dưới dạng json với các trường "relationships".\n\n```json\n{\n  "relationships": [\n    {\n      "source": {\n        "name": "trận đấu",\n        "description": "trận đấu trong world cup"\n      },\n      "target": {\n        "name": "90 phút",\n        "description": "thời gian của trận đấu"\n      },\n      "type_source": "event",\n      "type_target": "time",\n      "relation": "có_thời_gian"\n    },\n    {\n      "source": {\n        "name": "trận đấu",\n        "description": "trận đấu trong world cup"\n      },\n      "target": {\n        "name": "hai hiệp đấu",\n        "description": "số lượng hiệp đấu trong trận đấu"\n      },\n      "type_source": "event",\n      "type_target": "number",\n      "relation": "có_số_lượng_hiệp_đấu"\n    },\n    {\n      "source": {\n        "name": "trận đấu",\n        "description": "trận đấu trong world cup"\n      },\n      "target": {\n        "name": "15 phút",\n        "description": "thời gian nghỉ giải lao giữa hai hiệp đấu"\n      },\n      "type_source": "event",\n      "type_target": "time",\n      "relation": "có_thời_gian_ngồi_giải_lao"\n    },\n    {\n      "source": {\n        "name": "trận đấu",\n        "description": "trận đấu trong world cup"\n      },\n      "target": {\n        "name": "bàn thắng",\n        "description": "bàn thắng trong trận đấu"\n      },\n      "type_source": "event",\n      "type_target": "goal",\n      "relation": "có_bàn_thắng"\n    },\n    {\n      "source": {\n        "name": "trận đấu",\n        "description": "trận đấu trong world cup"\n      },\n      "target": {\n        "name": "thẻ phạt",\n        "description": "thẻ phạt trong trận đấu"\n      },\n      "type_source": "event",\n      "type_target": "card",\n      "relation": "có_thẻ_phạt"\n    }\n  ]\n}\n```\n\ntôi sẽ tiếp tục trích xuất thông tin từ văn bản và trả về kết quả dưới dạng json với các trường "relationships".\n\n```json\n{\n  "relationships": [\n    {\n      "source": {\n        "name": "vòng loại trực tiếp",\n        "description": "vòng đấu của world cup"\n      },\n      "target": {\n        "name": "hai hiệp đấu",\n        "description": "số lượng hiệp đấu trong vòng loại trực tiếp"\n      },\n      "type_source": "event",\n      "type_target": "number",\n      "relation": "có_số_lượng_hiệp_đấu"\n    },\n    {\n      "source": {\n        "name": "vòng loại trực tiếp",\n        "description": "vòng đấu của world cup"\n      },\n      "target": {\n        "name": "30 phút",\n        "description": "thời gian của hiệp phụ trong vòng loại trực tiếp"\n      },\n      "type_source": "event",\n      "type_target": "time",\n      "relation": "có_thời_gian_hiệp_phụ"\n    },\n    {\n      "source": {\n        "name": "vòng loại trực tiếp",\n        "description": "vòng đấu của world cup"\n      },\n      "target": {\n        "name": "bàn thắng bạc",\n        "description": "bàn thắng bạc trong vòng loại trực tiếp"\n      },\n      "type_source": "event",\n      "type_target": "goal",\n      "relation": "có_bàn_thắng_bạc"\n    },\n    {\n      "source": {\n        "name": "vòng loại trực tiếp",\n        "description": "vòng đấu của world cup"\n      },\n      "target": {\n        "name": "đá luân lưu",\n        "description": "đá luân lưu trong vòng loại trực tiếp"\n      },\n      "type_source": "event",\n      "type_target": "penalty",\n      "relation": "có_đá_luân_lưu"\n    }\n  ]\n}\n```\n\ntôi hy vọng thông tin này hữu ích cho bạn. nếu bạn cần thêm thông tin, vui lòng cho tôi biết.'

match = re.search(r'(\{\s*.*\})', raw_er, re.DOTALL)
if match:
    json_str = match.group(1)
    try:
        er_json = json.loads(json_str)
        print(er_json)
    except json.JSONDecodeError as e:
        print("Lỗi parse JSON:", e)
